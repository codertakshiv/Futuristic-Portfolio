'use client';

import { useState } from 'react';
import { motion } from 'framer-motion';

interface ProjectCardProps {
  project: {
    title: string;
    description: string;
    tech: string[];
    image: string;
    href: string;
    demoLabel: string;
    featured: boolean;
  };
  index: number;
}

export default function ProjectCard({ project, index }: ProjectCardProps) {
  const [isHovered, setIsHovered] = useState(false);
  const [tilt, setTilt] = useState({ x: 0, y: 0 });

  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {
    const rect = e.currentTarget.getBoundingClientRect();
    const x = (e.clientX - rect.left) / rect.width;
    const y = (e.clientY - rect.top) / rect.height;
    
    setTilt({
      x: (y - 0.5) * 10,
      y: (x - 0.5) * -10
    });
  };

  const handleMouseLeave = () => {
    setTilt({ x: 0, y: 0 });
    setIsHovered(false);
  };

  return (
    <motion.article
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ delay: index * 0.1 }}
      className={`group relative overflow-hidden rounded-2xl border border-white/10 bg-black/40 backdrop-blur-md transition-all duration-500 hover:scale-[1.02] hover:border-white/20 hover:shadow-[0_20px_40px_rgba(0,0,0,0.6)] ${
        project.featured ? 'ring-1 ring-cyan-500/20 ring-offset-0 ring-offset-black/40' : ''
      }`}
      onMouseMove={handleMouseMove}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={handleMouseLeave}
      style={{
        transform: `perspective(1000px) rotateX(${tilt.x}deg) rotateY(${tilt.y}deg)`,
      }}
    >
      {/* Featured Badge */}
      {project.featured && (
        <motion.div
          initial={{ opacity: 0, scale: 0 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ delay: 0.2 }}
          className="absolute top-4 right-4 z-10 rounded-full bg-gradient-to-r from-cyan-500 to-fuchsia-500 px-3 py-1 text-xs text-white shadow-lg"
        >
          Featured
        </motion.div>
      )}

      {/* Image Container with Enhanced Hover Effect */}
      <div className="relative h-48 overflow-hidden">
        <motion.img
          src={project.image}
          alt={project.title}
          className="h-full w-full object-cover"
          animate={{
            scale: isHovered ? 1.1 : 1,
            opacity: isHovered ? 1 : 0.9,
          }}
          transition={{ duration: 0.7 }}
        />
        
        {/* Gradient Overlay */}
        <motion.div
          className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"
          animate={{ opacity: isHovered ? 1 : 0.7 }}
          transition={{ duration: 0.5 }}
        />
        
        {/* Enhanced Hover Reveal Effect */}
        <motion.div
          className="absolute inset-0 bg-gradient-to-br from-cyan-500/10 via-transparent to-fuchsia-500/10"
          animate={{ opacity: isHovered ? 1 : 0 }}
          transition={{ duration: 0.5 }}
        />

        {/* Animated Particles on Hover */}
        {isHovered && (
          <div className="absolute inset-0">
            {[...Array(5)].map((_, i) => (
              <motion.div
                key={i}
                className="absolute h-1 w-1 bg-cyan-400 rounded-full"
                initial={{ 
                  x: Math.random() * 100, 
                  y: Math.random() * 100,
                  opacity: 0
                }}
                animate={{ 
                  x: Math.random() * 100, 
                  y: Math.random() * 100,
                  opacity: [0, 1, 0]
                }}
                transition={{ 
                  duration: 2, 
                  repeat: Infinity,
                  delay: i * 0.2
                }}
              />
            ))}
          </div>
        )}
      </div>

      {/* Content */}
      <div className="p-5 space-y-4">
        {/* Title and Description */}
        <div className="space-y-2">
          <motion.h3
            animate={{ color: isHovered ? '#00ffff' : '#ffffff' }}
            transition={{ duration: 0.3 }}
            className="text-xl font-semibold"
          >
            {project.title}
          </motion.h3>
          <motion.p
            animate={{ 
              color: isHovered ? 'rgba(255, 255, 255, 0.9)' : 'rgba(255, 255, 255, 0.6)',
              y: isHovered ? -2 : 0
            }}
            transition={{ duration: 0.5 }}
            className="text-sm leading-relaxed"
          >
            {project.description}
          </motion.p>
        </div>

        {/* Tech Stack */}
        <div className="flex flex-wrap gap-2">
          {project.tech.map((tech, techIndex) => (
            <motion.span
              key={tech}
              initial={{ opacity: 0, scale: 0.8 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: techIndex * 0.05 }}
              whileHover={{ 
                scale: 1.1,
                borderColor: 'rgba(0, 255, 255, 0.3)',
                backgroundColor: 'rgba(0, 255, 255, 0.1)',
                color: '#00ffff'
              }}
              className="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white/70 transition-all duration-300 cursor-default"
            >
              {tech}
            </motion.span>
          ))}
        </div>

        {/* Action Button */}
        <div className="flex items-center justify-between pt-2">
          <motion.a
            href={project.href}
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            animate={{ 
              y: isHovered ? 0 : 4,
              opacity: isHovered ? 1 : 0.9
            }}
            transition={{ duration: 0.3 }}
            className="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-cyan-500 to-fuchsia-500 px-4 py-2.5 text-sm font-medium text-white shadow-lg shadow-cyan-500/20 hover:shadow-fuchsia-500/30 hover:brightness-110"
          >
            {project.demoLabel}
            <motion.svg
              animate={{ x: isHovered ? 4 : 0 }}
              transition={{ duration: 0.3 }}
              className="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </motion.svg>
          </motion.a>
          
          {/* Quick Stats */}
          <div className="flex gap-3 text-xs text-white/50">
            <motion.span
              animate={{ opacity: isHovered ? 1 : 0.7 }}
              className="flex items-center gap-1"
            >
              <svg className="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                <path fillRule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clipRule="evenodd" />
              </svg>
              {9464}
            </motion.span>
            <motion.span
              animate={{ opacity: isHovered ? 1 : 0.7 }}
              className="flex items-center gap-1"
            >
              <svg className="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clipRule="evenodd" />
              </svg>
              {1528}
            </motion.span>
          </div>
        </div>
      </div>

      {/* Animated Border Effect */}
      <motion.div
        className="absolute inset-0 rounded-2xl bg-gradient-to-r from-cyan-500 via-fuchsia-500 to-violet-500"
        animate={{ opacity: isHovered ? 0.2 : 0 }}
        transition={{ duration: 0.5 }}
        style={{ mixBlendMode: 'overlay' }}
      />
    </motion.article>
  );
}
